var FWD;FWD=function(){function a(){}return a.init=function(a){return this.devKey=a},a.getDevKey=function(){return this.devKey||function(){throw"FWD DevKey required."}()},a.allPagesPerPage=100,a}();var slice=[].slice;FWD.URL=function(){function a(){}return a.host="https://app.fwd.us/api/v1",a.urls={legislators:{index:"/legislators",search:"/legislators/search",show:function(a){return"/legislators/"+a}},letters:{index:"/letters",show:function(a){return"/letters/"+a}},selfies:{index:"/selfies",show:function(a){return"/selfies/"+a},gallery:"/selfies/gallery",celebrities:"/selfies/celebrities"},companies:{index:"/companies"},stories:{index:"/stories",show:function(a){return"/stories/"+a},search:"/stories/search"},articles:{press:"/articles/press"}},a["for"]=function(a){var b,c,d,e;return e=a.split("#"),c=e[0],b=e[1],d=this.urls[c][b],$.isFunction(d)?function(a){return function(){var b;return b=1<=arguments.length?slice.call(arguments,0):[],a.host.concat(d.apply(null,b),".json")}}(this):this.host.concat(d,".json")},a}();var bind=function(a,b){return function(){return a.apply(b,arguments)}};FWD.Model=function(){function a(a){null==a&&(a={}),this.set=bind(this.set,this),this.get=bind(this.get,this),this.attributes=$.extend({},a)}return a.prototype.get=function(a){return this.attributes[a]},a.prototype.set=function(a,b){return this.attributes[a]=b},a}(),FWD.Api=function(){function a(){}return a.promiseCache={},a.get=function(a,b){return b=$.extend({key:FWD.getDevKey()},b),$.getJSON(a,b)},a.getModel=function(a){var b,c,d;return d=a.url,c=a.modelClass,b=a.jsonField,$.Deferred(function(a){return function(e){return a.get(d,{}).fail(e.reject).done(function(a){var d;return d=new c(a[b]),e.resolve(d,a)})}}(this)).promise()},a.getPage=function(b){var c,d,e,f;return f=b.url,d=b.params,c=null!=(e=b.arrayParams)?e:[],d=a.convertArrayParams(d,c),a.get(f,d)},a.getModelPage=function(b){var c,d;return d=b.modelClass,c=b.jsonCollection,$.Deferred(function(e){return a.getPage(b).fail(e.reject).done(function(b){var f;return f=a.attributeCollectionToModels(b[c],d),e.resolve(f,b)})}).promise()},a.getAllPages=function(b,c,d){return $.Deferred(function(e){var f,g;return d=$.extend({},d,{page:1,per_page:FWD.allPagesPerPage}),f=[],g=function(h){var i;return f=f.concat(h[c]),i=h.page,i<h.total_pages?(d.page=i+1,a.get(b,d).fail(e.reject).done(g)):e.resolve(f)},a.get(b,d).fail(e.reject).done(g)}).promise()},a.getAllModels=function(b){var c,d,e,f,g,h,i,j,k;return k=b.url,f=b.modelClass,e=b.jsonCollection,g=b.params,c=null!=(i=b.arrayParams)?i:[],d=null!=(j=b.cacheResponse)?j:!1,d&&a.promiseCache[k]?a.promiseCache[k]:(h=$.Deferred(function(b){var d;return g=a.convertArrayParams(g,c),d=a.getAllPages(k,e,g),d.fail(b.reject).done(function(c){var d;return d=a.attributeCollectionToModels(c,f),b.resolve(d)})}).promise(),d&&(a.promiseCache[k]=h),h)},a.convertArrayParams=function(b,c){return $.isArray(c)?(b=$.extend({},b),$.each(c,function(c,d){return b[d]=a.arrayParam(b[d])}),b):void 0},a.arrayParam=function(a){return $.isArray(a)?a.join(","):a},a.attributeCollectionToModels=function(a,b){return $.map(a,function(a){return new b(a)})},a}();var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Article=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.press=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("articles#press"),jsonCollection:"articles",modelClass:b,arrayParams:["tags"],params:a})},b}(FWD.Model);var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Company=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.loadAll=function(a){return null==a&&(a={}),FWD.Api.getAllModels({url:FWD.URL["for"]("companies#index"),jsonCollection:"companies",modelClass:b,cacheResponse:!0,params:a})},b.load=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("companies#index"),jsonCollection:"companies",modelClass:b,params:a})},b.find=function(a){return $.Deferred(function(c){return b.loadAll().fail(c.reject).done(function(b){var d,e,f;for(e=0,f=b.length;f>e;e++)if(d=b[e],d.get("id")===a)return void c.resolve(d);return c.reject()})}).promise()},b}(FWD.Model);var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Legislator=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.index=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("legislators#index"),jsonCollection:"legislators",modelClass:b,params:a})},b.search=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("legislators#search"),jsonCollection:"legislators",modelClass:b,params:a})},b.show=function(a){var c;return c=FWD.URL["for"]("legislators#show"),FWD.Api.getModel({url:c(a),jsonField:"legislator",modelClass:b})},b}(FWD.Model);var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Letter=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.index=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("letters#index"),jsonCollection:"letters",modelClass:b,params:a})},b.show=function(a){var c;return c=FWD.URL["for"]("letters#show"),FWD.Api.getModel({url:c(a),jsonField:"letter",modelClass:b})},b}(FWD.Model);var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Selfie=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.index=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("selfies#index"),jsonCollection:"selfies",modelClass:b,params:a})},b.show=function(a){var c;return c=FWD.URL["for"]("selfies#show"),FWD.Api.getModel({url:c(a),jsonField:"selfie",modelClass:b})},b.gallery=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("selfies#gallery"),jsonCollection:"selfies",modelClass:b,params:a})},b.celebrities=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("selfies#celebrities"),jsonCollection:"selfies",modelClass:b,params:a})},b}(FWD.Model);var bind=function(a,b){return function(){return a.apply(b,arguments)}},extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Story=function(a){function b(){return this.company=bind(this.company,this),b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.index=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("stories#index"),jsonCollection:"stories",modelClass:b,params:a})},b.show=function(a){var c;return c=FWD.URL["for"]("stories#show"),FWD.Api.getModel({url:c(a),jsonField:"story",modelClass:b})},b.search=function(a){return FWD.Api.getModelPage({url:FWD.URL["for"]("stories#search"),jsonCollection:"stories",arrayParams:["company","tags"],modelClass:b,params:a})},b.searchAll=function(a){return FWD.Api.getAllModels({url:FWD.URL["for"]("stories#search"),jsonCollection:"stories",modelClass:b,arrayParams:["company","tags"],params:a})},b.prototype.company=function(){return this.get("company_id")?FWD.Company.find(this.get("company_id")):$.Deferred(function(a){return a.reject()}).promise()},b}(FWD.Model);