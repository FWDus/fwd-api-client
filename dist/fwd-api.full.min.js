var FWD;FWD=function(){function a(){}return a.init=function(a){return this.devKey=a},a.getDevKey=function(){return this.devKey||function(){throw"FWD DevKey required."}()},a.allPagesPerPage=100,a}();var slice=[].slice;FWD.URL=function(){function a(){}return a.host="https://app.fwd.us/api/v1",a.urls={companies:{index:"/companies.json"},stories:{index:"/stories.json",show:function(a){return"/stories/"+a+".json"},search:"/stories/search.json"},articles:{press:"/articles/press.json"}},a["for"]=function(a){var b,c,d,e;return e=a.split("#"),c=e[0],b=e[1],d=this.urls[c][b],$.isFunction(d)?function(a){return function(){var b;return b=1<=arguments.length?slice.call(arguments,0):[],a.host.concat(d.apply(null,b))}}(this):this.host.concat(d)},a}();var bind=function(a,b){return function(){return a.apply(b,arguments)}};FWD.Model=function(){function a(a){null==a&&(a={}),this.set=bind(this.set,this),this.get=bind(this.get,this),this.attributes=$.extend({},a)}return a.prototype.get=function(a){return this.attributes[a]},a.prototype.set=function(a,b){return this.attributes[a]=b},a}();var slice=[].slice;FWD.Factory=function(){function a(){}return a.loadResourceFunc=function(a){var b,c,d;return d=a.url,c=a.model,b=a.jsonField,function(){var a;return a=1<=arguments.length?slice.call(arguments,0):[],$.Deferred(function(e){return $.isFunction(d)&&(d=d(a[0])),FWD.Api.get(d,{}).fail(e.reject).done(function(a){var d;return d=new c(a[b]),e.resolve(d,a)})}).promise()}},a.loadPageFunc=function(b){var c,d,e,f;return f=b.url,e=b.model,d=b.collectionName,c=b.arrayParams,c||(c=[]),function(b){return $.Deferred(function(g){var h;return h=a.convertArrayParams(b,c),FWD.Api.get(f,h).fail(g.reject).done(function(b){var c;return c=a.attributesToModels(b[d],e),g.resolve(c,b)})}).promise()}},a.loadAllFunc=function(b){var c,d,e,f,g,h;return h=b.url,g=b.model,f=b.collectionName,c=b.arrayParams,d=b.cache,c||(c=[]),e=null,function(b){return d&&e?e:e=$.Deferred(function(d){var e,i;return i=a.convertArrayParams(b,c),e=FWD.Api.getAllPages(h,f,i),e.fail(d.reject).done(function(b){var c;return c=a.attributesToModels(b,g),d.resolve(c)})}).promise()}},a.convertArrayParams=function(b,c){return b=$.extend({},b),$.each(c,function(c,d){return b[d]=a.arrayParam(b[d])}),b},a.arrayParam=function(a){return $.isArray(a)?a.join(","):a},a.attributesToModels=function(a,b){return $.map(a,function(a){return new b(a)})},a}(),FWD.Api=function(){function a(){}return a.get=function(a,b){return b=$.extend({key:FWD.getDevKey()},b),$.getJSON(a,b)},a.getAllPages=function(b,c,d){return $.Deferred(function(e){var f,g;return d=$.extend({},d,{page:1,per_page:FWD.allPagesPerPage}),f=[],g=function(h){var i;return f=f.concat(h[c]),i=h.page,i<h.total_pages?(d.page=i+1,a.get(b,d).fail(e.reject).done(g)):e.resolve(f)},a.get(b,d).fail(e.reject).done(g)}).promise()},a}();var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Article=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.press=FWD.Factory.loadPageFunc({url:FWD.URL["for"]("articles#press"),collectionName:"articles",model:b,arrayParams:["tags"]}),b}(FWD.Model);var extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Company=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.loadAll=FWD.Factory.loadAllFunc({url:FWD.URL["for"]("companies#index"),collectionName:"companies",model:b,cache:!0}),b.load=FWD.Factory.loadPageFunc({url:FWD.URL["for"]("companies#index"),collectionName:"companies",model:b}),b.find=function(a){return $.Deferred(function(c){return b.loadAll().fail(c.reject).done(function(b){var d,e,f;for(e=0,f=b.length;f>e;e++)if(d=b[e],d.get("id")===a)return void c.resolve(d);return c.reject()})}).promise()},b}(FWD.Model);var bind=function(a,b){return function(){return a.apply(b,arguments)}},extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty;FWD.Story=function(a){function b(){return this.company=bind(this.company,this),b.__super__.constructor.apply(this,arguments)}return extend(b,a),b.index=FWD.Factory.loadPageFunc({url:FWD.URL["for"]("stories#index"),collectionName:"stories",model:b}),b.show=FWD.Factory.loadResourceFunc({url:FWD.URL["for"]("stories#show"),jsonField:"story",model:b}),b.search=FWD.Factory.loadPageFunc({url:FWD.URL["for"]("stories#search"),collectionName:"stories",model:b,arrayParams:["company","tags"]}),b.searchAll=FWD.Factory.loadAllFunc({url:FWD.URL["for"]("stories#search"),collectionName:"stories",model:b,arrayParams:["company","tags"]}),b.prototype.company=function(){return this.get("company_id")?FWD.Company.find(this.get("company_id")):$.Deferred(function(a){return a.reject()}).promise()},b}(FWD.Model);